<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üíò –í–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞</title>
  <style>
    :root {
      --bg1:#ffdee9;
      --bg2:#b5fffc;
      --card:#ffffffcc;
      --text:#1f2937;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 20% 20%, var(--bg1), transparent),
                  radial-gradient(1200px 800px at 80% 80%, var(--bg2), transparent),
                  #fff;
      color: var(--text);
      overflow: hidden;
    }
    .card {
      width: min(92vw, 560px);
      background: var(--card);
      backdrop-filter: blur(10px);
      border: 1px solid #ffffff80;
      border-radius: 24px;
      padding: 28px 22px;
      box-shadow: 0 20px 60px rgba(0,0,0,.12);
      text-align: center;
      position: relative;
      z-index: 1;
    }
    h1 {
      margin: 0 0 10px;
      font-size: clamp(22px, 4.5vw, 34px);
      line-height: 1.15;
    }
    p { margin: 0 0 18px; opacity: .85; }

    .btns {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 10px;
      position: relative;
      z-index: 2;
    }

    button {
      border: 0;
      padding: 12px 18px;
      border-radius: 14px;
      font-size: 16px;
      cursor: pointer;
      transition: transform .08s ease, box-shadow .2s ease, opacity .2s ease;
      user-select: none;
      touch-action: manipulation;
      line-height: 1;
    }

    #yes {
      background: #ff4d6d;
      color: white;
      box-shadow: 0 10px 25px rgba(255,77,109,.35);
    }
    #yes:active { transform: translateY(1px) scale(.99); }

    /* –°–¢–ê–†–¢–û–í–û: "–ù–µ—Ç" –æ–±—ã—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤ —Ä—è–¥—É */
    #no {
      background: #111827;
      color: white;
      box-shadow: 0 10px 25px rgba(17,24,39,.25);
      position: relative; /* –ø–æ—Ç–æ–º –ø–µ—Ä–µ–∫–ª—é—á–∏–º –Ω–∞ fixed */
    }

    .result {
      margin-top: 18px;
      display: none;
      animation: pop .35s ease;
    }
    .result img {
      width: min(320px, 80vw);
      border-radius: 18px;
      border: 2px solid #ffffffaa;
      box-shadow: 0 16px 45px rgba(0,0,0,.18);
      display: block;
      margin: 12px auto 0;
    }
    .badge {
      display: inline-block;
      margin-top: 10px;
      padding: 8px 12px;
      border-radius: 999px;
      background: #ffffffd9;
      border: 1px solid #ffffffaa;
      font-weight: 600;
    }
    @keyframes pop {
      from { transform: scale(.96); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .hearts {
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: .35;
      z-index: 0;
    }
  </style>
</head>
<body>
  <canvas class="hearts" id="hearts"></canvas>

  <div class="card" id="card">
    <h1>–ë—É–¥–µ—à—å –º–æ–µ–π –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π? üíò</h1>
    <p>–í—ã–±–æ—Ä –≤—Å–µ–≥–æ –æ–¥–∏–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π üòÑ</p>

    <!-- –í–ê–ñ–ù–û: "–î–∞" –∏ "–ù–µ—Ç" —Ä—è–¥–æ–º -->
    <div class="btns" id="btns">
      <button id="yes">–î–∞</button>
      <button id="no" aria-label="–ù–µ—Ç">–ù–µ—Ç</button>
    </div>

    <div class="result" id="result">
      <div class="badge">–£—Ä–∞–∞–∞! üíñ</div>
      <div style="font-size:18px;margin-top:10px;">–¢–æ–≥–¥–∞ –¥–µ—Ä–∂–∏ –º–µ–Ω—è üòå</div>
      <img id="photo" src="myphoto.jpg" alt="–§–æ—Ç–æ" />
    </div>
  </div>

  <script>
    const noBtn = document.getElementById("no");
    const yesBtn = document.getElementById("yes");
    const result = document.getElementById("result");

    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º "–ù–µ—Ç" –≤ —Ä–µ–∂–∏–º —É–±–µ–≥–∞–Ω–∏—è –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π "–ø–æ–ø—ã—Ç–∫–∏"
    let noIsEscaping = false;

    function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }

    function enableNoEscapeMode() {
      if (noIsEscaping) return;
      noIsEscaping = true;

      // –ë–µ—Ä—ë–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –∫–Ω–æ–ø–∫–∏ –≤ —Ä—è–¥—É –∏ —Å—Ç–∞–≤–∏–º –µ—ë —Ç—É–¥–∞ –∂–µ, –Ω–æ —É–∂–µ fixed
      const rect = noBtn.getBoundingClientRect();
      noBtn.style.position = "fixed";
      noBtn.style.left = rect.left + "px";
      noBtn.style.top = rect.top + "px";
      noBtn.style.transform = "none";
      noBtn.style.zIndex = "9999";
      noBtn.style.willChange = "left, top";

      // —á—É—Ç—å –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
      noBtn.style.transition = "left .08s ease, top .08s ease, transform .08s ease, box-shadow .2s ease, opacity .2s ease";
    }

    function safeMoveNoButton(nearX = null, nearY = null) {
      enableNoEscapeMode();

      const padding = 14;
      const w = noBtn.offsetWidth;
      const h = noBtn.offsetHeight;

      const minX = padding;
      const minY = padding;
      const maxX = window.innerWidth  - w - padding;
      const maxY = window.innerHeight - h - padding;

      // –µ—Å–ª–∏ —ç–∫—Ä–∞–Ω —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π ‚Äî –¥–µ—Ä–∂–∏–º –∫–Ω–æ–ø–∫—É –≤–Ω–∏–∑—É –ø–æ —Ü–µ–Ω—Ç—Ä—É
      if (maxX <= minX || maxY <= minY) {
        noBtn.style.left = "50%";
        noBtn.style.top = "80%";
        noBtn.style.transform = "translate(-50%, -50%)";
        return;
      }

      let x = Math.random() * (maxX - minX) + minX;
      let y = Math.random() * (maxY - minY) + minY;

      // –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã "–ø–æ–≥–æ–Ω–∏" ‚Äî —É–ª–µ—Ç–∞–µ–º –ø–æ–¥–∞–ª—å—à–µ –æ—Ç –Ω–∏—Ö
      if (nearX !== null && nearY !== null) {
        const fromLeft = (nearX < window.innerWidth / 2);
        const fromTop  = (nearY < window.innerHeight / 2);

        // —Ç–æ–ª–∫–∞–µ–º –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–π –∫–≤–∞–¥—Ä–∞–Ω—Ç
        x = fromLeft ? (Math.random() * (maxX - window.innerWidth/2) + window.innerWidth/2)
                     : (Math.random() * (window.innerWidth/2 - minX) + minX);

        y = fromTop  ? (Math.random() * (maxY - window.innerHeight/2) + window.innerHeight/2)
                     : (Math.random() * (window.innerHeight/2 - minY) + minY);

        // —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞
        x = clamp(x, minX, maxX);
        y = clamp(y, minY, maxY);
      }

      noBtn.style.left = x + "px";
      noBtn.style.top  = y + "px";
      noBtn.style.transform = "none";
    }

    // –°—Ç—Ä–∞—Ö–æ–≤–∫–∞: –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –≤–¥—Ä—É–≥ –æ–∫–∞–∑–∞–ª–∞—Å—å –≤–Ω–µ –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏ (–∏–∑-–∑–∞ —Ä–µ—Å–∞–π–∑–∞/—Å–∫—Ä–æ–ª–ª–∞ –∏ —Ç.–ø.)
    function ensureNoVisible() {
      if (!noIsEscaping) return;

      const r = noBtn.getBoundingClientRect();
      const margin = 6;
      const out =
        r.right < margin ||
        r.bottom < margin ||
        r.left > window.innerWidth - margin ||
        r.top > window.innerHeight - margin;

      if (out) safeMoveNoButton(window.innerWidth/2, window.innerHeight/2);
    }

    window.addEventListener("resize", () => {
      // –ø—Ä–∏ —Ä–µ—Å–∞–π–∑–µ –ø—Ä–æ—Å—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞
      ensureNoVisible();
    });

    // –£–±–µ–≥–∞–µ—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –º—ã—à–∏ (–ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ escape —Ä–µ–∂–∏–º–∞)
    noBtn.addEventListener("mouseenter", (e) => safeMoveNoButton(e.clientX, e.clientY));

    // –ù–∞ –º–æ–±–∏–ª–µ: —É–±–µ–≥–∞–µ—Ç, –∫–æ–≥–¥–∞ –ø–∞–ª–µ—Ü –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–∂–∞—Ç—å
    noBtn.addEventListener("touchstart", (e) => {
      const t = e.touches[0];
      safeMoveNoButton(t.clientX, t.clientY);
      e.preventDefault();
    }, { passive: false });

    // –ï—Å–ª–∏ –≤—Å—ë-—Ç–∞–∫–∏ –∫–ª–∏–∫–Ω—É–ª–∏ ‚Äî —Ç–æ–∂–µ —É–ª–µ—Ç–∞–µ—Ç
    noBtn.addEventListener("click", (e) => safeMoveNoButton(e.clientX, e.clientY));

    // "–î–∞" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ç–∫—É –∏ –ø—Ä—è—á–µ—Ç "–ù–µ—Ç"
    yesBtn.addEventListener("click", () => {
      result.style.display = "block";
      noBtn.style.display = "none";
      yesBtn.disabled = true;
      yesBtn.style.opacity = "0.7";
      burstHearts();
    });

    // –°–µ—Ä–¥–µ—á–∫–∏
    const c = document.getElementById("hearts");
    const ctx = c.getContext("2d");
    const hearts = [];
    function resizeCanvas(){
      c.width = window.innerWidth;
      c.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function spawnHeart(x, y, big=false){
      hearts.push({
        x, y,
        vy: -(2 + Math.random()*2) * (big ? 1.4 : 1),
        vx: (Math.random()*2-1) * (big ? 1.2 : 1),
        s: (6 + Math.random()*10) * (big ? 1.6 : 1),
        a: 1,
        r: Math.random()*Math.PI
      });
    }

    function burstHearts(){
      const cx = window.innerWidth/2;
      const cy = window.innerHeight/2;
      for(let i=0;i<26;i++) spawnHeart(cx + (Math.random()*120-60), cy + (Math.random()*60-30), true);
    }

    // –ª—ë–≥–∫–∏–π "–¥–æ–∂–¥—å" —Å–µ—Ä–¥–µ—Ü
    setInterval(() => {
      if (Math.random() < 0.6) spawnHeart(Math.random()*window.innerWidth, window.innerHeight + 10);
    }, 220);

    function drawHeart(x,y,s,rot,alpha){
      ctx.save();
      ctx.translate(x,y);
      ctx.rotate(rot);
      ctx.globalAlpha = alpha;
      ctx.fillStyle = "#ff4d6d";
      ctx.beginPath();
      const k = s/16;
      ctx.moveTo(0, 6*k);
      ctx.bezierCurveTo(0, 0, -8*k, 0, -8*k, 6*k);
      ctx.bezierCurveTo(-8*k, 12*k, 0, 14*k, 0, 18*k);
      ctx.bezierCurveTo(0, 14*k, 8*k, 12*k, 8*k, 6*k);
      ctx.bezierCurveTo(8*k, 0, 0, 0, 0, 6*k);
      ctx.fill();
      ctx.restore();
    }

    function tick(){
      ctx.clearRect(0,0,c.width,c.height);
      for(let i=hearts.length-1;i>=0;i--){
        const h = hearts[i];
        h.x += h.vx;
        h.y += h.vy;
        h.vy -= 0.02;
        h.a -= 0.012;
        h.r += 0.02;
        drawHeart(h.x,h.y,h.s,h.r,Math.max(0,h.a));
        if (h.a <= 0) hearts.splice(i,1);
      }
      requestAnimationFrame(tick);
    }
    tick();

    // –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ (–º–∞–ª–æ –ª–∏)
    setInterval(ensureNoVisible, 800);
  </script>
</body>
</html>
